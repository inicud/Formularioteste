<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Procuração</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #fff;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            min-height: 100vh;
        }
        .fade-in {
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-up {
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .input-container {
            position: relative;
        }
        .input-label {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            transition: all 0.2s;
            pointer-events: none;
            color: #64748b;
        }
        input:focus + .input-label,
        input:not(:placeholder-shown) + .input-label,
        select:focus + .input-label,
        select:not([value=""]) + .input-label {
            top: -8px;
            font-size: 12px;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 0 8px;
            color: #3b82f6;
        }
        .progress-bar {
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .error-shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: all 0.2s;
        }
        .tooltip-trigger:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4 py-12">

    <!-- Progress Tracker -->
    <div class="fixed top-0 left-0 w-full h-1.5 bg-slate-800/50 backdrop-blur-sm z-50">
        <div id="progressBar" class="progress-bar h-full bg-gradient-to-r from-blue-500 to-cyan-500" style="width: 0%"></div>
    </div>

    <div id="app" class="w-full max-w-2xl">
        <!-- Header -->
        <div class="text-center mb-12 fade-in">
            <div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-blue-500/10 mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-400">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                    <polyline points="10 9 9 9 8 9"/>
                </svg>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold mb-2 bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">
                Formulário de Procuração
            </h1>
            <p class="text-slate-400">Preencha seus dados para gerar o documento</p>
        </div>

        <!-- Form Step Content -->
        <div id="stepContainer" class="fade-in bg-slate-800/30 backdrop-blur-xl rounded-2xl p-8 border border-slate-700/50 shadow-2xl">
            <div class="mb-6">
                <p id="stepLabel" class="text-slate-400 text-xs uppercase tracking-widest mb-1 font-semibold"></p>
                <h2 id="stepQuestion" class="text-2xl md:text-3xl font-semibold text-white"></h2>
            </div>
            
            <div id="inputWrapper" class="mb-8"></div>

            <div id="errorMessage" class="hidden mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
                <span id="errorText"></span>
            </div>

            <div class="flex items-center justify-between gap-4">
                <button id="prevBtn" class="flex items-center gap-2 text-slate-400 hover:text-white transition-all disabled:opacity-0 disabled:pointer-events-none px-4 py-2 rounded-lg hover:bg-slate-700/50">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="19" y1="12" x2="5" y2="12"/>
                        <polyline points="12 19 5 12 12 5"/>
                    </svg>
                    Voltar
                </button>
                <div class="flex flex-col items-end gap-2">
                    <button id="nextBtn" class="flex items-center gap-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-3 rounded-xl font-semibold hover:shadow-lg hover:shadow-blue-500/50 transition-all active:scale-95">
                        <span id="nextBtnText">Próximo</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="5" y1="12" x2="19" y2="12"/>
                            <polyline points="12 5 19 12 12 19"/>
                        </svg>
                    </button>
                    <span class="text-slate-500 text-xs">Pressione ENTER ↵</span>
                </div>
            </div>
        </div>

        <!-- Success Screen -->
        <div id="successScreen" class="hidden text-center fade-in bg-slate-800/30 backdrop-blur-xl rounded-2xl p-12 border border-slate-700/50 shadow-2xl">
            <div class="mb-6 inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-500/10 text-green-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="slide-up">
                    <path d="M20 6L9 17l-5-5"/>
                </svg>
            </div>
            <h2 class="text-4xl font-bold mb-3 text-white">Concluído!</h2>
            <p class="text-slate-400 mb-8 text-lg">Seu arquivo JSON foi gerado e baixado com sucesso.</p>
            <div class="flex gap-4 justify-center">
                <button onclick="window.location.reload()" class="flex items-center gap-2 bg-slate-700 hover:bg-slate-600 px-6 py-3 rounded-xl transition-all font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="1 4 1 10 7 10"/>
                        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
                    </svg>
                    Novo Formulário
                </button>
            </div>
        </div>

        <!-- Review Screen -->
        <div id="reviewScreen" class="hidden fade-in bg-slate-800/30 backdrop-blur-xl rounded-2xl p-8 border border-slate-700/50 shadow-2xl">
            <div class="mb-6">
                <h2 class="text-2xl md:text-3xl font-semibold text-white mb-2">Revise seus dados</h2>
                <p class="text-slate-400">Confira se todas as informações estão corretas</p>
            </div>
            
            <div id="reviewContent" class="space-y-4 mb-8 max-h-96 overflow-y-auto pr-2"></div>

            <div class="flex items-center justify-between gap-4">
                <button id="reviewBackBtn" class="flex items-center gap-2 text-slate-400 hover:text-white transition-all px-4 py-2 rounded-lg hover:bg-slate-700/50">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="19" y1="12" x2="5" y2="12"/>
                        <polyline points="12 19 5 12 12 5"/>
                    </svg>
                    Editar
                </button>
                <button id="confirmBtn" class="flex items-center gap-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white px-8 py-3 rounded-xl font-semibold hover:shadow-lg hover:shadow-green-500/50 transition-all active:scale-95">
                    <span>Confirmar e Baixar</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        const fields = [
            { 
                id: "nome", 
                label: "Nome Completo", 
                question: "Qual o seu nome completo?",
                type: "text",
                placeholder: "Ex: João Silva Santos",
                validate: (v) => v.trim().length >= 3 ? null : "Nome deve ter pelo menos 3 caracteres"
            },
            { 
                id: "nacionalidade", 
                label: "Nacionalidade", 
                question: "Qual sua nacionalidade?",
                type: "text",
                placeholder: "Ex: Brasileiro(a)",
                validate: (v) => v.trim().length >= 3 ? null : "Nacionalidade inválida"
            },
            { 
                id: "estado_civil", 
                label: "Estado Civil", 
                question: "Qual seu estado civil?",
                type: "select",
                options: ["Solteiro(a)", "Casado(a)", "Divorciado(a)", "Viúvo(a)", "Separado(a)"],
                validate: (v) => v ? null : "Selecione um estado civil"
            },
            { 
                id: "profissao", 
                label: "Profissão", 
                question: "Qual sua profissão atual?",
                type: "text",
                placeholder: "Ex: Engenheiro(a)",
                validate: (v) => v.trim().length >= 2 ? null : "Profissão inválida"
            },
            { 
                id: "cpf", 
                label: "CPF", 
                question: "Qual o seu CPF?",
                type: "text",
                placeholder: "000.000.000-00",
                mask: "cpf",
                validate: (v) => {
                    const cpf = v.replace(/\D/g, '');
                    return cpf.length === 11 ? null : "CPF deve ter 11 dígitos";
                }
            },
            { 
                id: "identidade", 
                label: "RG / Identidade", 
                question: "Qual o seu RG?",
                type: "text",
                placeholder: "Ex: MG-12.345.678",
                validate: (v) => v.trim().length >= 5 ? null : "RG inválido"
            },
            { 
                id: "rua", 
                label: "Rua", 
                question: "Qual o nome da rua?",
                type: "text",
                placeholder: "Ex: Rua das Flores",
                validate: (v) => v.trim().length >= 3 ? null : "Nome da rua inválido"
            },
            { 
                id: "numero", 
                label: "Número", 
                question: "Qual o número da residência?",
                type: "text",
                placeholder: "Ex: 123",
                validate: (v) => v.trim().length >= 1 ? null : "Número obrigatório"
            },
            { 
                id: "complemento", 
                label: "Complemento (opcional)", 
                question: "Algum complemento?",
                type: "text",
                placeholder: "Ex: Apto 45, Bloco B",
                optional: true
            },
            { 
                id: "bairro", 
                label: "Bairro", 
                question: "Qual o bairro?",
                type: "text",
                placeholder: "Ex: Centro",
                validate: (v) => v.trim().length >= 2 ? null : "Bairro inválido"
            },
            { 
                id: "cidade", 
                label: "Cidade", 
                question: "Em qual cidade você mora?",
                type: "text",
                placeholder: "Ex: Betim",
                validate: (v) => v.trim().length >= 2 ? null : "Cidade inválida"
            },
            { 
                id: "uf", 
                label: "Estado (UF)", 
                question: "Qual o Estado?",
                type: "select",
                options: ["AC", "AL", "AP", "AM", "BA", "CE", "DF", "ES", "GO", "MA", "MT", "MS", "MG", "PA", "PB", "PR", "PE", "PI", "RJ", "RN", "RS", "RO", "RR", "SC", "SP", "SE", "TO"],
                validate: (v) => v ? null : "Selecione um estado"
            },
            { 
                id: "cep", 
                label: "CEP", 
                question: "Qual o seu CEP?",
                type: "text",
                placeholder: "00000-000",
                mask: "cep",
                validate: (v) => {
                    const cep = v.replace(/\D/g, '');
                    return cep.length === 8 ? null : "CEP deve ter 8 dígitos";
                }
            }
        ];

        let currentStep = 0;
        const formData = {};

        const stepLabel = document.getElementById('stepLabel');
        const stepQuestion = document.getElementById('stepQuestion');
        const inputWrapper = document.getElementById('inputWrapper');
        const nextBtn = document.getElementById('nextBtn');
        const nextBtnText = document.getElementById('nextBtnText');
        const prevBtn = document.getElementById('prevBtn');
        const progressBar = document.getElementById('progressBar');
        const stepContainer = document.getElementById('stepContainer');
        const successScreen = document.getElementById('successScreen');
        const reviewScreen = document.getElementById('reviewScreen');
        const errorMessage = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');

        function applyMask(value, type) {
            if (type === 'cpf') {
                return value
                    .replace(/\D/g, '')
                    .replace(/(\d{3})(\d)/, '$1.$2')
                    .replace(/(\d{3})(\d)/, '$1.$2')
                    .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }
            if (type === 'cep') {
                return value
                    .replace(/\D/g, '')
                    .replace(/(\d{5})(\d)/, '$1-$2');
            }
            return value;
        }

        function showError(message) {
            errorText.textContent = message;
            errorMessage.classList.remove('hidden');
            inputWrapper.classList.add('error-shake');
            setTimeout(() => inputWrapper.classList.remove('error-shake'), 500);
        }

        function hideError() {
            errorMessage.classList.add('hidden');
        }

        function createInput(field) {
            inputWrapper.innerHTML = '';
            hideError();

            if (field.type === 'select') {
                const select = document.createElement('select');
                select.id = 'currentInput';
                select.className = 'w-full bg-slate-700/50 border-2 border-slate-600 rounded-xl px-4 py-4 text-lg font-medium text-white transition-all appearance-none cursor-pointer';
                
                const placeholder = document.createElement('option');
                placeholder.value = '';
                placeholder.textContent = 'Selecione...';
                placeholder.disabled = true;
                placeholder.selected = true;
                select.appendChild(placeholder);

                field.options.forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt;
                    option.textContent = opt;
                    select.appendChild(option);
                });

                select.value = formData[field.id] || '';
                inputWrapper.appendChild(select);
                select.focus();
            } else {
                const input = document.createElement('input');
                input.type = 'text';
                input.id = 'currentInput';
                input.className = 'w-full bg-slate-700/50 border-2 border-slate-600 rounded-xl px-4 py-4 text-lg font-medium text-white placeholder-slate-500 transition-all';
                input.placeholder = field.placeholder || 'Digite aqui...';
                input.value = formData[field.id] || '';
                input.autocomplete = 'off';

                if (field.mask) {
                    input.addEventListener('input', (e) => {
                        e.target.value = applyMask(e.target.value, field.mask);
                    });
                }

                inputWrapper.appendChild(input);
                input.focus();
            }
        }

        function updateUI() {
            const field = fields[currentStep];
            stepLabel.textContent = `Passo ${currentStep + 1} de ${fields.length}`;
            stepQuestion.textContent = field.question;
            
            createInput(field);
            
            const progress = ((currentStep + 1) / fields.length) * 100;
            progressBar.style.width = `${progress}%`;

            prevBtn.disabled = currentStep === 0;
            
            if (currentStep === fields.length - 1) {
                nextBtnText.textContent = 'Revisar';
            } else {
                nextBtnText.textContent = 'Próximo';
            }

            stepContainer.classList.remove('fade-in');
            void stepContainer.offsetWidth;
            stepContainer.classList.add('fade-in');
        }

        function handleNext() {
            const field = fields[currentStep];
            const input = document.getElementById('currentInput');
            const value = input.value.trim();

            if (!field.optional && field.validate) {
                const error = field.validate(value);
                if (error) {
                    showError(error);
                    return;
                }
            }

            formData[field.id] = value;

            if (currentStep < fields.length - 1) {
                currentStep++;
                updateUI();
            } else {
                showReview();
            }
        }

        function handlePrev() {
            if (currentStep > 0) {
                currentStep--;
                updateUI();
            }
        }

        function showReview() {
            stepContainer.classList.add('hidden');
            reviewScreen.classList.remove('hidden');

            const reviewContent = document.getElementById('reviewContent');
            reviewContent.innerHTML = '';

            fields.forEach((field, index) => {
                const value = formData[field.id] || '—';
                const item = document.createElement('div');
                item.className = 'flex justify-between items-start p-4 bg-slate-700/30 rounded-xl border border-slate-600/50 hover:border-slate-500/50 transition-all cursor-pointer';
                item.onclick = () => {
                    currentStep = index;
                    reviewScreen.classList.add('hidden');
                    stepContainer.classList.remove('hidden');
                    updateUI();
                };
                
                item.innerHTML = `
                    <div>
                        <p class="text-slate-400 text-xs uppercase tracking-wide mb-1">${field.label}</p>
                        <p class="text-white font-medium">${value}</p>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-slate-500">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                `;
                
                reviewContent.appendChild(item);
            });
        }

        function saveData() {
            progressBar.style.width = "100%";
            
            const jsonString = JSON.stringify(formData, null, 4);
            const blob = new Blob([jsonString], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement("a");
            link.href = url;
            link.download = "dados_formulario.json";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            reviewScreen.classList.add('hidden');
            successScreen.classList.remove('hidden');
        }

        // Event Listeners
        nextBtn.addEventListener('click', handleNext);
        prevBtn.addEventListener('click', handlePrev);
        
        document.getElementById('reviewBackBtn').addEventListener('click', () => {
            reviewScreen.classList.add('hidden');
            stepContainer.classList.remove('hidden');
        });

        document.getElementById('confirmBtn').addEventListener('click', saveData);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !reviewScreen.classList.contains('hidden')) {
                saveData();
            } else if (e.key === 'Enter' && !stepContainer.classList.contains('hidden')) {
                handleNext();
            }
        });

        // Initialize
        updateUI();
    </script>
</body>
</html>